document.addEventListener("DOMContentLoaded",()=>{let d=document.getElementById("create-course-form"),c=document.getElementById("courseTitle"),l=document.getElementById("courseDescription"),m=document.getElementById("courseBanner"),u=document.getElementById("courseCardImage"),g=document.getElementById("bannerPreview"),h=document.getElementById("cardPreview"),e=document.getElementById("banner-error"),t=document.getElementById("card-error"),r=(t,r,a,n)=>{let o=t.files[0];if(o){let e=new Image;e.onload=()=>{e.width!==n.width||e.height!==n.height?(a.textContent=`A imagem deve ter exatamente ${n.width}x${n.height} pixels.`,r.style.display="none",t.value=""):(a.textContent="",r.src=URL.createObjectURL(o),r.style.display="block")},e.src=URL.createObjectURL(o)}else r.style.display="none",a.textContent=""},p=(e,t="warning")=>{var r=document.getElementById("alert-placeholder-create"),a=document.createElement("div");a.className=`alert alert-${t} alert-dismissible fade show`,a.role="alert",a.innerHTML=`
            ${e}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        `,r.appendChild(a)};m.addEventListener("change",()=>{r(m,g,e,{width:970,height:250})}),u.addEventListener("change",()=>{r(u,h,t,{width:300,height:200})}),d.addEventListener("submit",async e=>{e.preventDefault();e=c.value.trim(),t=l.value.trim(),r=m.files[0],a=u.files[0];e=e?t?r?a?{title:e,description:t,banner:r,cardImage:a}:(p("A imagem do card é obrigatória."),!1):(p("O banner do curso é obrigatório."),!1):(p("A descrição do curso é obrigatória."),!1):(p("O título do curso é obrigatório."),!1);if(e){var{title:t,description:r,banner:a,cardImage:e}=e,n=new FormData;n.append("title",t),n.append("description",r),n.append("banner",a),n.append("image",e);try{var o,i,s=await fetch(apiUrl+"coursesPostRequest",{method:"POST",body:n});s.ok?"error"===(o=await s.json()).status?p("Erro ao criar o curso: "+o.message):(p("Curso criado com sucesso!"),d.reset(),g.style.display="none",h.style.display="none",fetchCourses()):(i=await s.json(),p("Erro ao criar o curso: "+i.message))}catch(e){console.error("Erro na requisição:",e),p("Erro ao criar o curso")}}})});